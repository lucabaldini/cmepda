\begin{Verbatim}[label=\makebox{\url{https://github.com/lucabaldini/cmepda/tree/master/slides/latex/snippets/wrapper.py}},commandchars=\\\{\}]
\PY{k}{def} \PY{n+nf}{some\PYZus{}function}\PY{p}{(}\PY{n}{a}\PY{p}{,} \PY{n}{b}\PY{p}{)}\PY{p}{:}
    \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Executing \PYZob{}\PYZcb{} x \PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{a}\PY{p}{,} \PY{n}{b}\PY{p}{)}\PY{p}{)}
    \PY{k}{return} \PY{n}{a} \PY{o}{*} \PY{n}{b}
    
\PY{k}{def} \PY{n+nf}{add\PYZus{}n\PYZus{}wrapper}\PY{p}{(}\PY{n}{func}\PY{p}{,} \PY{n}{n}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{} We take the wrapped function as argument}
    \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} This wrapper adds n to the result of the wrapped function\PYZdq{}\PYZdq{}\PYZdq{}}
    
    \PY{k}{def} \PY{n+nf}{wrapper}\PY{p}{(}\PY{o}{*}\PY{n}{args}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)}\PY{p}{:} 
       \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}We passs the arguments as *arg, **kwargs, because this is the most}
\PY{l+s+sd}{       general form in Python: we can collect any comination of arguments like}
\PY{l+s+sd}{       that. Note that we have access to both \PYZsq{}func\PYZsq{} and \PYZsq{}n\PYZsq{}, as they are stored}
\PY{l+s+sd}{       in the closure of \PYZsq{}wrapper\PYZsq{}\PYZdq{}\PYZdq{}\PYZdq{}}
       \PY{n}{result} \PY{o}{=} \PY{n}{func}\PY{p}{(}\PY{o}{*}\PY{n}{args}\PY{p}{,} \PY{o}{*}\PY{o}{*}\PY{n}{kwargs}\PY{p}{)} \PY{c+c1}{\PYZsh{} Pass the arguments to the wrapped fucntion}
       \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Adding \PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{)}
       \PY{k}{return} \PY{n}{result} \PY{o}{+} \PY{n}{n} \PY{c+c1}{\PYZsh{} Return a modified result in this case}
       
    \PY{k}{return} \PY{n}{wrapper} \PY{c+c1}{\PYZsh{} From add\PYZus{}n\PYZus{}wrapper we return the wrapper}

\PY{n}{function\PYZus{}plus\PYZus{}five} \PY{o}{=} \PY{n}{add\PYZus{}n\PYZus{}wrapper}\PY{p}{(}\PY{n}{some\PYZus{}function}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}
\PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Result = \PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{function\PYZus{}plus\PYZus{}five}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}\PY{p}{)}

[Output]
Executing 2 x 3
Adding 5
Result = 11
\end{Verbatim}